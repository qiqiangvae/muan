---
title: 计算机硬件
date: 2023-06-21 18:53:20
permalink: /note/systemArchitecture/hardware/
---

# 计算机硬件

## CPU

### 运算器

执行所有的算术运算，如加减乘除等；执行所有的逻辑运算并进行逻辑测试，如与、或、非、比较；

1. 算数逻辑单元ALU（Arithmetic Logic Unit），实现对数据的算术和逻辑运算，；
2. 累加寄存器AC（Accumulator register），运算结果或源操作数的存放区；
3. 数据缓冲寄存器DR（Data Register），暂时存放内存的指令或数据；
4. 状态条件寄存器PSW（Program Status Word），保存指令运行结果的条件码内容，如溢出标志；

### 控制器

CPU依据指令周期的不同阶段来区分二进制的指令和数据，因为在指令周期的不同阶段，指令会命令CPU去取指令或数据。

1. 程序计数器PC（Program Counter），具有寄存信息和计数两种功能，一般用来存放下一条指令在主存储器中的地址；
2. 指令寄存器IR（Instruction Register），暂存CPU当前要执行指令；
3. 指令译码器ID（Instruction Decoder），分析和解析操作码；
4. 地址寄存器AR（Address Register），保存当前CPU所访问的内存地址；

## 校验码

### 码距

码距指单个编码如A：00只需要改变一位就会变成另一个编码，那么它的码距就是1。在两个编码中，从A码变为B码所需要改变的位数成为码距。

如A：00变为B：11，其码距为2。一半来说，码距越大，越利于纠错和检错。

### 奇偶校验码

如果一个编码中有奇数个1，那么就是奇校验，反之则是偶校验。奇偶校验码的码距为2，因为本身有一位是错误，导致校验码也错误，所以码距为2。

奇偶校验码只能检错不能纠错。

### CRC

原始编码为A`1100`，多项式如下
$$
G(x)=x3+x+1
$$

求编码A的CRC

多项式的最高位是3，那么R=3，在编码A后面补3个0，可以确定被除数是`1100000`。根据多项式中x的位数，确定除数是`1011`。将`1100000`
除以`1011`（即做异或运算）

<img src="https://qiqiang.oss-cn-hangzhou.aliyuncs.com/muan/UdV7yk.jpg" alt="UdV7yk" style="zoom: 25%;" />

算出来之后是`10`，因为R=3，所以需要在前面补一个0即`010`，那么最终的CRC校验码为`1100010`

## 指令系统

一条计算机指令由操作码和操作数两部分组成，操作码决定要完成的操作，操作数指参加运算的数据及其所在的单元地址。

计算机执行执行的过程：取指令 -> 分析指令 -> 执行指令。

首先将程序计数器PC中的指令地址取出，送入地址总线，CPU根据指令地址去内存中取出指令内容存入指令寄存器IR，然后由指令译码器进行分析指令操作码，最后执行指令，取出指令执行所需要的源操作数。

### 指令寻址方式

* 立即寻址方式：指令的地址码存在不是地址，而是操作数本身；
* 直接寻址方式：指令的地址码存的是操作数在主存中的地址；
* 间接寻址方式：指令的地址码存的是操作数的地址（饶了一次）；
* 寄存器寻址方式：指令的地址码存在是寄存器的编号；
* 基址寻址方式：
* 变址寻址方式：

### 指令系统

| 指令系统类型       | 指令                | 寻址方式  | 实现方式                       | 其它                          |
|--------------|-------------------|-------|----------------------------|-----------------------------|
| CISC（复杂指令系统） | 数量多，使用频率差别打，可变长格式 | 支持多种  | 微程序控制技术                    | 研制周期长；以Intel、AMD的x86CPU为代码  |
| RISC（精简指令系统） | 数量少，使用频率接近，定长格式   | 支持方式少 | 增加了通用寄存器；硬布线逻辑控制为主，适合采用流水线 | 优化编译，有效支持高级语言；以ARM和Power为代表 |

#### 指令流水线

##### 指令流水线原理

将指令分为不同的段，每段由不同的部分去处理，不同指令的取址分析和执行可以同时执行，因此可以产生叠加效果。

##### 指令流水线技术

1. 超流水线技术：细化流水，比如一个流水线本来是3段，可以分为6段执行，以时间换空间；
2. 超标量技术：增加硬件，已空间换时间；
3. 超长指令字技术：通过软件，以空间换时间；

##### 相关公式

1. 流水线周期：指令分为不同执行段，其中执行段最长的时间为流水线周期；

2. 流水线执行时间：
   $$
   1条指令总执行时间+(总指令数-1)*流水线周期
   $$
   

3. 流水线吞吐率计算：吞吐率即单位时间内执行指令的条数。
   $$
   指令条数/流水线执行时间
   $$

4. 流水线的加速比：
   $$
   不使用流水线执行时间/使用流水线执行时间
   $$
   

## 存储系统

计算机采用分级存储主要是为了解决存储容量、成本和速度之间的矛盾。

### 高速存储Cache

高速存储Cache用来存储当前最活跃的程序和数据，容量小，直接与CPU交互，速度是主存的5-10倍，由半导体材料构成。其内容是主存的副本拷贝。

Cache由控制部分和存储器组成，存储器存储数据，控制部分判断CPU要访问的数据是否在Cache中，如果命中则返回，没有命中则从主存中获取。

在CPU工作时，送出的是主存单元地址，而应从Cache存储器中读写信息，此时需要将主存地址转换为Cache存储器地址。这种地址转换被称为地址映射，由**硬件自动完成**，由如下三种方式：

1. 直接映射；
2. 全相联映射；
3. 组相联映射（1,2组合）；

三种方式按照块冲突概率从高到低排序是，1,3,2；

#### 替换算法

* 随机替换算法
* 先进先出算法
* 近期最少使用算法
* 优化替换算法

### 局部性原理

空间局部性原理：相邻的地址可能会被访问，比如数组；

时间局部性原理：相近的时间内，同一个地址可能会被再次访问；