<!doctype html><html lang="en-US"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="generator" content="VuePress 2.0.0-rc.23" /><meta name="theme" content="VuePress Theme Plume 1.0.0-rc.153" /><script id="check-mac-os">document.documentElement.classList.toggle('mac', /Mac|iPhone|iPod|iPad/i.test(navigator.platform))</script><script id="check-dark-mode">;(function () {const um= localStorage.getItem('vuepress-theme-appearance') || 'auto';const sm = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;const isDark = um === 'dark' || (um !== 'light' && sm);document.documentElement.dataset.theme = isDark ? 'dark' : 'light';})();</script><title>k8s之Job与CronJob | 作草分茶</title><meta name="description" content="作草分茶的生活和技术的记录"><link rel="preload" href="/assets/style-DfjY-ina.css" as="style"><link rel="stylesheet" href="/assets/style-DfjY-ina.css"><link rel="modulepreload" href="/assets/app-PgFgktk8.js"><link rel="modulepreload" href="/assets/index.html-Box3QYY2.js"></head><body><div id="app"><!--[--><!--[--><div class="theme-plume vp-layout" vp-container data-v-1a104101><!--[--><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0d99eeba></span><a href="#VPContent" class="vp-skip-link visually-hidden" data-v-0d99eeba> Skip to content </a><!--]--><!----><header class="vp-nav" data-v-dac6e797><div class="vp-navbar" vp-navbar data-v-dac6e797 data-v-36473ad7><div class="wrapper" data-v-36473ad7><div class="container" data-v-36473ad7><div class="title" data-v-36473ad7><div class="vp-navbar-title has-sidebar" data-v-36473ad7 data-v-f4039fba><a class="vp-link no-icon link title" href="/" data-v-f4039fba data-v-c3d337d2><!--[--><!--[--><!--]--><!----><span data-v-f4039fba>作草分茶</span><!--[--><!--]--><!--]--><!----></a></div></div><div class="content" data-v-36473ad7><div class="content-body" data-v-36473ad7><!--[--><!--]--><div class="vp-navbar-search search" data-v-36473ad7><div class="search-wrapper" data-v-f040cfef><!----><div id="local-search" data-v-f040cfef><button type="button" class="mini-search mini-search-button" aria-label="Search" data-v-f040cfef><span class="mini-search-button-container"><span class="mini-search-search-icon vpi-mini-search" aria-label="search icon"></span><span class="mini-search-button-placeholder">Search</span></span><span class="mini-search-button-keys"><kbd class="mini-search-button-key"></kbd><kbd class="mini-search-button-key">K</kbd></span></button></div></div></div><!--[--><!--]--><nav aria-labelledby="main-nav-aria-label" class="vp-navbar-menu menu" data-v-36473ad7 data-v-f35c0059><span id="main-nav-aria-label" class="visually-hidden" data-v-f35c0059>Main Navigation</span><!--[--><!--[--><a class="vp-link no-icon link navbar-menu-link" href="/" tabindex="0" data-v-f35c0059 data-v-a9080319 data-v-c3d337d2><!--[--><!----><span data-v-a9080319>首页</span><!----><!--]--><!----></a><!--]--><!--[--><a class="vp-link no-icon link navbar-menu-link" href="/dev/soft-and-web/" tabindex="0" data-v-f35c0059 data-v-a9080319 data-v-c3d337d2><!--[--><!----><span data-v-a9080319>开发技术</span><!----><!--]--><!----></a><!--]--><!--[--><a class="vp-link no-icon link navbar-menu-link" href="/java/toolUsage/79030a/" tabindex="0" data-v-f35c0059 data-v-a9080319 data-v-c3d337d2><!--[--><!----><span data-v-a9080319>Java</span><!----><!--]--><!----></a><!--]--><!--[--><a class="vp-link no-icon link navbar-menu-link" href="/cloudNative/d3cfc7/" tabindex="0" data-v-f35c0059 data-v-a9080319 data-v-c3d337d2><!--[--><!----><span data-v-a9080319>云原生</span><!----><!--]--><!----></a><!--]--><!--[--><a class="vp-link no-icon link navbar-menu-link" href="/llm/start/" tabindex="0" data-v-f35c0059 data-v-a9080319 data-v-c3d337d2><!--[--><!----><span data-v-a9080319>大模型</span><!----><!--]--><!----></a><!--]--><!--[--><a class="vp-link no-icon link navbar-menu-link" href="/linux/db53d7/" tabindex="0" data-v-f35c0059 data-v-a9080319 data-v-c3d337d2><!--[--><!----><span data-v-a9080319>Linux</span><!----><!--]--><!----></a><!--]--><!--[--><a class="vp-link no-icon link navbar-menu-link" href="/middleware/" tabindex="0" data-v-f35c0059 data-v-a9080319 data-v-c3d337d2><!--[--><!----><span data-v-a9080319>中间件</span><!----><!--]--><!----></a><!--]--><!--[--><a class="vp-link no-icon link navbar-menu-link" href="/note/systemArchitecture/hardware/" tabindex="0" data-v-f35c0059 data-v-a9080319 data-v-c3d337d2><!--[--><!----><span data-v-a9080319>学习笔记</span><!----><!--]--><!----></a><!--]--><!--]--></nav><!--[--><!--]--><!----><div class="vp-navbar-appearance appearance" data-v-36473ad7 data-v-4701f7a6><button class="vp-switch vp-switch-appearance" type="button" role="switch" title aria-checked="false" data-v-4701f7a6 data-v-1532aba1 data-v-d8f83072><span class="check" data-v-d8f83072><span class="icon" data-v-d8f83072><!--[--><span class="vpi-sun sun" data-v-1532aba1></span><span class="vpi-moon moon" data-v-1532aba1></span><!--]--></span></span></button></div><!----><div class="vp-flyout vp-navbar-extra extra" data-v-36473ad7 data-v-b96c19ba data-v-09ed1d4f><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-09ed1d4f><span class="vpi-more-horizontal icon" data-v-09ed1d4f></span></button><div class="menu" data-v-09ed1d4f><div class="vp-menu" data-v-09ed1d4f data-v-8019ae6d><!----><!--[--><!--[--><!----><div class="group" data-v-b96c19ba><div class="item appearance" data-v-b96c19ba><p class="label" data-v-b96c19ba>Appearance</p><div class="appearance-action" data-v-b96c19ba><button class="vp-switch vp-switch-appearance" type="button" role="switch" title aria-checked="false" data-v-b96c19ba data-v-1532aba1 data-v-d8f83072><span class="check" data-v-d8f83072><span class="icon" data-v-d8f83072><!--[--><span class="vpi-sun sun" data-v-1532aba1></span><span class="vpi-moon moon" data-v-1532aba1></span><!--]--></span></span></button></div></div></div><!----><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="vp-navbar-hamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="nav-screen" data-v-36473ad7 data-v-f5f0fc48><span class="container" data-v-f5f0fc48><span class="top" data-v-f5f0fc48></span><span class="middle" data-v-f5f0fc48></span><span class="bottom" data-v-f5f0fc48></span></span></button></div></div></div></div><div class="divider" data-v-36473ad7><div class="divider-line" data-v-36473ad7></div></div></div><!----></header><div class="vp-local-nav reached-top" data-v-b23c80dc><button class="menu" aria-expanded="false" aria-controls="SidebarNav" data-v-b23c80dc><span class="vpi-align-left menu-icon" data-v-b23c80dc></span><span class="menu-text" data-v-b23c80dc>Menu</span></button><div class="vp-local-nav-outline-dropdown" style="--vp-vh:0px;" data-v-b23c80dc data-v-2cfdce9a><button data-v-2cfdce9a>Return to top</button><!----></div></div><aside class="vp-sidebar" vp-sidebar data-v-1df09d8a><div class="curtain" data-v-1df09d8a></div><nav id="SidebarNav" class="nav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-1df09d8a><span id="sidebar-aria-label" class="visually-hidden" data-v-1df09d8a> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-0e9e7fff><section class="vp-sidebar-item sidebar-item level-0 has-active" data-v-0e9e7fff data-v-2ced3841><!----><div data-v-2ced3841 data-v-2ced3841><div class="items" data-v-2ced3841><!--[--><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-2ced3841 data-v-2ced3841><div class="item" data-v-2ced3841><div class="indicator" data-v-2ced3841></div><!----><a class="vp-link no-icon link link" href="/cloudNative/d3cfc6/" data-v-2ced3841 data-v-c3d337d2><!--[--><p class="text" data-v-2ced3841><span data-v-2ced3841>docker 基本使用</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-2ced3841 data-v-2ced3841><div class="item" data-v-2ced3841><div class="indicator" data-v-2ced3841></div><!----><a class="vp-link no-icon link link" href="/cloudNative/d3cfc7/" data-v-2ced3841 data-v-c3d337d2><!--[--><p class="text" data-v-2ced3841><span data-v-2ced3841>docker 代理服务器配置</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-2ced3841 data-v-2ced3841><div class="item" data-v-2ced3841><div class="indicator" data-v-2ced3841></div><!----><a class="vp-link no-icon link link" href="/cloudNative/81e7b1/" data-v-2ced3841 data-v-c3d337d2><!--[--><p class="text" data-v-2ced3841><span data-v-2ced3841>k8s 常用命令</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-2ced3841 data-v-2ced3841><div class="item" data-v-2ced3841><div class="indicator" data-v-2ced3841></div><!----><a class="vp-link no-icon link link" href="/cloudNative/db014d/" data-v-2ced3841 data-v-c3d337d2><!--[--><p class="text" data-v-2ced3841><span data-v-2ced3841>k8s之Job与CronJob</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-2ced3841 data-v-2ced3841><div class="item" data-v-2ced3841><div class="indicator" data-v-2ced3841></div><!----><a class="vp-link no-icon link link" href="/cloudNative/dab1f6/" data-v-2ced3841 data-v-c3d337d2><!--[--><p class="text" data-v-2ced3841><span data-v-2ced3841>Macos-minikube</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-2ced3841 data-v-2ced3841><div class="item" data-v-2ced3841><div class="indicator" data-v-2ced3841></div><!----><a class="vp-link no-icon link link" href="/cloudNative/517b0e/" data-v-2ced3841 data-v-c3d337d2><!--[--><p class="text" data-v-2ced3841><span data-v-2ced3841>Ubuntu使用kubeadm安装k8s集群</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-2ced3841 data-v-2ced3841><div class="item" data-v-2ced3841><div class="indicator" data-v-2ced3841></div><!----><a class="vp-link no-icon link link" href="/cloudNative/cfd207/" data-v-2ced3841 data-v-c3d337d2><!--[--><p class="text" data-v-2ced3841><span data-v-2ced3841>探索k8s过程中的问题和解决方案</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-2ced3841 data-v-2ced3841><div class="item" data-v-2ced3841><div class="indicator" data-v-2ced3841></div><!----><a class="vp-link no-icon link link" href="/cloudNative/104ac5/" data-v-2ced3841 data-v-c3d337d2><!--[--><p class="text" data-v-2ced3841><span data-v-2ced3841>k8s持久化存储</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-2ced3841 data-v-2ced3841><div class="item" data-v-2ced3841><div class="indicator" data-v-2ced3841></div><!----><a class="vp-link no-icon link link" href="/cloudNative/23c98b/" data-v-2ced3841 data-v-c3d337d2><!--[--><p class="text" data-v-2ced3841><span data-v-2ced3841>k8s 使用 StatefulSet 搭建 Redis 主从模式</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-2ced3841 data-v-2ced3841><div class="item" data-v-2ced3841><div class="indicator" data-v-2ced3841></div><!----><a class="vp-link no-icon link link" href="/cloudNative/104a10/" data-v-2ced3841 data-v-c3d337d2><!--[--><p class="text" data-v-2ced3841><span data-v-2ced3841>K8s部署单机Mysql</span><!----></p><!--]--><!----></a><!----></div><!----></div><!--]--></div></div></section></div><!--]--><!--[--><!--]--></nav></aside><!--[--><div id="VPContent" vp-content class="vp-content has-sidebar" data-v-3ba1f5b2><div class="vp-doc-container has-sidebar has-aside" data-v-3ba1f5b2 data-v-fa1c9a26><!--[--><!--]--><div class="container" data-v-fa1c9a26><div class="aside" vp-outline data-v-fa1c9a26><div class="aside-curtain" data-v-fa1c9a26></div><div class="aside-container" data-v-fa1c9a26><div class="aside-content" data-v-fa1c9a26><div class="vp-doc-aside" data-v-fa1c9a26 data-v-77b6200e><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="vp-doc-aside-outline" role="navigation" data-v-77b6200e data-v-ef12f8b7><div class="content" data-v-ef12f8b7><div class="outline-marker" data-v-ef12f8b7></div><div id="doc-outline-aria-label" aria-level="2" class="outline-title" role="heading" data-v-ef12f8b7><span data-v-ef12f8b7>On this page</span><span class="vpi-print icon" data-v-ef12f8b7></span></div><ul class="root" data-v-ef12f8b7 data-v-6b490c6d><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-77b6200e></div><!--[--><!--]--></div></div></div></div><div class="content" data-v-fa1c9a26><div class="content-container" data-v-fa1c9a26><!--[--><!--]--><main class="main" data-v-fa1c9a26><nav class="vp-breadcrumb" data-v-fa1c9a26 data-v-ea9f4c5f><ol vocab="https://schema.org/" typeof="BreadcrumbList" data-v-ea9f4c5f><!--[--><li property="itemListElement" typeof="ListItem" data-v-ea9f4c5f><a class="vp-link no-icon link breadcrumb" href="/" property="item" typeof="WebPage" data-v-ea9f4c5f data-v-c3d337d2><!--[-->Home<!--]--><!----></a><span class="vpi-chevron-right" data-v-ea9f4c5f></span><meta property="name" content="Home" data-v-ea9f4c5f><meta property="position" content="1" data-v-ea9f4c5f></li><li property="itemListElement" typeof="ListItem" data-v-ea9f4c5f><a class="vp-link no-icon link breadcrumb current" href="/cloudNative/db014d/" property="item" typeof="WebPage" data-v-ea9f4c5f data-v-c3d337d2><!--[-->k8s之Job与CronJob<!--]--><!----></a><!----><meta property="name" content="k8s之Job与CronJob" data-v-ea9f4c5f><meta property="position" content="2" data-v-ea9f4c5f></li><!--]--></ol></nav><!--[--><!--]--><!--[--><h1 class="vp-doc-title page-title" data-v-82eaff1d>k8s之Job与CronJob <!----></h1><div class="vp-doc-meta" data-v-82eaff1d><!--[--><!--]--><p class="reading-time" data-v-82eaff1d><span class="vpi-books icon" data-v-82eaff1d></span><span data-v-82eaff1d>About 435 words</span><span data-v-82eaff1d>About 1 min</span></p><!----><!--[--><!--]--><p class="create-time" data-v-82eaff1d><span class="vpi-clock icon" data-v-82eaff1d></span><span data-v-82eaff1d>2022-05-20</span></p></div><!--]--><!--[--><!--]--><div class="_cloudNative_db014d_ external-link-icon-enabled vp-doc plume-content" vp-content data-v-fa1c9a26><!--[--><!--]--><div data-v-fa1c9a26><h1 id="k8s之job与cronjob" tabindex="-1"><a class="header-anchor" href="#k8s之job与cronjob"><span>k8s之Job与CronJob</span></a></h1><h2 id="简单的-job" tabindex="-1"><a class="header-anchor" href="#简单的-job"><span>简单的 Job</span></a></h2><p>一个典型的 Job 配置文件如下：</p><div class="language-yaml line-numbers-mode" data-ext="yaml" data-title="yaml"><button class="copy" title="Copy code" data-copied="Copied"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">apiVersion</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> batch/v1</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">kind</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Job</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">metadata</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">  name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> job-pi</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">spec</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">  template</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    spec</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">      containers</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        -</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> job-pi</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">          image</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> resouer/ubuntu-bc</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">          command</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> [</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">sh</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">-c</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">echo &quot;scale=10000; 4*a(1)&quot; | bc -l </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> ]</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">      restartPolicy</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> OnFailure</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>创建 Job</p><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="Copy code" data-copied="Copied"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> kubectl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> apply</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -f</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> job-pi.yaml</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>查看 job，可以看到 job 已经创建了，完成数量为0</p><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="Copy code" data-copied="Copied"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> kubectl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> get</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> job</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">             </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">NAME</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">     COMPLETIONS</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">   DURATION</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">   AGE</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">job-pi</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">   0/1</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">           8s</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">         8s</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>看看 Job 的详情信息</p><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="Copy code" data-copied="Copied"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> kubectl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> describe</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> jobs/job-pi</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Name:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">             job-pi</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Namespace:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        default</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Selector:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">         controller-uid=09473d71-64ca-4342-84fc-83f721d1fe92</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Labels:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">           controller-uid=09473d71-64ca-4342-84fc-83f721d1fe92</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">                  job-name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">job-pi</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Annotations:</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">      &lt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">non</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">e</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Parallelism:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">      1</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Completions:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">      1</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Completion</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Mode:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  NonIndexed</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Start</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Time:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">       Sat,</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 21</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> May</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 2022</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 12:52:52</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> +0800</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Pods</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Statuses:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">    1</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Running</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Succeeded</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Failed</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Pod</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Template:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  Labels:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  controller-uid=09473d71-64ca-4342-84fc-83f721d1fe92</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">           job-name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">job-pi</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  Containers:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">   job-pi:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    Image:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">      resouer/ubuntu-bc</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    Port:</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">       &lt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">non</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">e</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    Host</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Port:</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">  &lt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">non</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">e</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    Command:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      sh</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      -c</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">      echo</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">scale=10000; 4*a(1)</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> |</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> bc</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -l</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    Environment:</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">  &lt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">non</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">e</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    Mounts:</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">       &lt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">non</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">e</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  Volumes:</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">        &lt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">non</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">e</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Events:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  Type</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">    Reason</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">            Age</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">   From</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">            Message</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  ----</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">    ------</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">            ----</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">  ----</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">            -------</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  Normal</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  SuccessfulCreate</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  18s</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">   job-controller</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  Created</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> pod:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> job-pi--1-fnbcg</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>看到 Events 里，Job 创建完成了，并且创建了一个名为 job-pi--1-fnbcg 的 Pod。</p><p>看下是不是真有这个 pod 被创建了</p><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="Copy code" data-copied="Copied"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> kubectl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> get</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> pod</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">                       </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">NAME</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">              READY</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">   STATUS</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">    RESTARTS</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">   AGE</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">job-pi--1-fnbcg</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">   1/1</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">     Running</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">   0</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">          53s</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以看到该 Pod 确实被创建了，正在运行中。</p><p>过一会儿再看下，发现已经完成了。</p><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="Copy code" data-copied="Copied"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> kubectl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> get</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> pod</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">NAME</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">              READY</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">   STATUS</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">      RESTARTS</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">   AGE</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">job-pi--1-fnbcg</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">   0/1</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">     Completed</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">   0</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">          7m52s</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>看下日志，确实已经计算完成了</p><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="Copy code" data-copied="Copied"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> kubectl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> logs</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> job-pi--1-fnbcg</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">3.14159265358979323846264338327950288419716939937510582…………</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>回头再看下 job 的状态，这时候发现已经完成了，耗时2m1s。</p><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="Copy code" data-copied="Copied"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">NAME</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">     COMPLETIONS</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">   DURATION</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">   AGE</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">job-pi</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">   1/1</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">           2m1s</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">       10m</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="参数" tabindex="-1"><a class="header-anchor" href="#参数"><span>参数</span></a></h3><div class="language-yaml line-numbers-mode" data-ext="yaml" data-title="yaml"><button class="copy" title="Copy code" data-copied="Copied"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">spec</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  # 失败重试次数</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">  backoffLimit</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 4</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  # 最大并行数量</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">  parallelism</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 2</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  # 最小完成数</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">  completions</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 4</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  # 最长运行时间</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">  activeDeadlineSeconds</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 100</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="cron-job" tabindex="-1"><a class="header-anchor" href="#cron-job"><span>Cron Job</span></a></h2></div><!----><!----><!----></div></main><footer class="vp-doc-footer" data-v-fa1c9a26 data-v-07c61dba><!--[--><!--]--><!----><div class="contributors" aria-label="Contributors" data-v-07c61dba><span class="contributors-label" data-v-07c61dba>Contributors: </span><span class="contributors-info" data-v-07c61dba><!--[--><!--[--><span class="contributor" data-v-07c61dba>qiqiang</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" data-v-07c61dba>Quince</span><!----><!--]--><!--]--></span></div><nav class="prev-next" data-v-07c61dba><div class="pager" data-v-07c61dba><a class="vp-link no-icon link pager-link prev" href="/cloudNative/81e7b1/" data-v-07c61dba data-v-c3d337d2><!--[--><span class="desc" data-v-07c61dba>Previous page</span><span class="title" data-v-07c61dba>k8s 常用命令</span><!--]--><!----></a></div><div class="pager" data-v-07c61dba><a class="vp-link no-icon link pager-link next" href="/cloudNative/dab1f6/" data-v-07c61dba data-v-c3d337d2><!--[--><span class="desc" data-v-07c61dba>Next page</span><span class="title" data-v-07c61dba>Macos-minikube</span><!--]--><!----></a></div></nav></footer><!----><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!--]--><button style="display:none;" type="button" class="vp-back-to-top" aria-label="back to top" data-v-39589565><span class="percent" data-allow-mismatch data-v-39589565>0%</span><span class="show icon vpi-back-to-top" data-v-39589565></span><svg aria-hidden="true" data-v-39589565><circle cx="50%" cy="50%" data-allow-mismatch style="stroke-dasharray:calc(0% - 12.566370614359172px) calc(314.1592653589793% - 12.566370614359172px);" data-v-39589565></circle></svg></button><footer class="vp-footer has-sidebar" vp-footer data-v-1db79341><!--[--><div class="container" data-v-1db79341><p class="message" data-v-1db79341>Powered by <a target="_blank" href="https://v2.vuepress.vuejs.org/">VuePress</a> & <a target="_blank" href="https://theme-plume.vuejs.press">vuepress-theme-plume</a></p><!----></div><!--]--></footer><!--[--><!--]--><!--]--></div><!----><!--]--><!--[--><!--]--><!--]--></div><script type="module" src="/assets/app-PgFgktk8.js" defer></script></body></html>