import{_ as i,c as a,b as n,o as e}from"./app-BZRVOKAf.js";const l={};function t(h,s){return e(),a("div",null,s[0]||(s[0]=[n(`<h2 id="介绍" tabindex="-1"><a class="header-anchor" href="#介绍"><span>介绍</span></a></h2><p>Arthas 是 Alibaba 开源的 Java 诊断工具。</p><p><a href="https://arthas.gitee.io/index.html" target="_blank" rel="noopener noreferrer">官网地址</a></p><h2 id="快速安装" tabindex="-1"><a class="header-anchor" href="#快速安装"><span>快速安装</span></a></h2><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="Copy code" data-copied="Copied"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">curl</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -O</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> https://arthas.aliyun.com/arthas-boot.jar</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">java</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -jar</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> arthas-boot.jar</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --repo-mirror</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> aliyun</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --use-http</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>连接已启动的arthas</p><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="Copy code" data-copied="Copied"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">telnet</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> localhost</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 3658</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="常用场景" tabindex="-1"><a class="header-anchor" href="#常用场景"><span>常用场景</span></a></h2><h3 id="反编译源码" tabindex="-1"><a class="header-anchor" href="#反编译源码"><span>反编译源码</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="Copy code" data-copied="Copied"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">jad</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> com.example.test</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="执行静态代码" tabindex="-1"><a class="header-anchor" href="#执行静态代码"><span>执行静态代码</span></a></h3><p>比如要看看临时目录路径</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><button class="copy" title="Copy code" data-copied="Copied"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">System</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">getProperty</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">java.io.tmpdir</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>那么需要先获取<code>java.lang.System</code>的类加载器hashcode，然后再执行代码</p><div class="hint-container info"><p class="hint-container-title">指定类加载器</p><p>使用<code>-c {hashcode}</code>指定类加载器，如果是Bootstrap可以不指定。</p><p>因为hashcode不是固定的，所以用<code>--classLoaderClass {classLoaderClassName}</code>指定类加载器可以保证唯一。</p></div><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="Copy code" data-copied="Copied"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">arthas@1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">$ sc -d java.lang.System</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> class-info</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        java.lang.System</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">                                                                                                                                                                                                        </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> code-source</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">                                                                                                                                                                                                                               </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> name</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">              java.lang.System</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">                                                                                                                                                                                                        </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> isInterface</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">       false</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">                                                                                                                                                                                                                   </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> isAnnotation</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">      false</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">                                                                                                                                                                                                                   </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> isEnum</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">            false</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">                                                                                                                                                                                                                   </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> isAnonymousClass</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">  false</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">                                                                                                                                                                                                                   </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> isArray</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">           false</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">                                                                                                                                                                                                                   </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> isLocalClass</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">      false</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">                                                                                                                                                                                                                   </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> isMemberClass</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">     false</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">                                                                                                                                                                                                                   </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> isPrimitive</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">       false</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">                                                                                                                                                                                                                   </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> isSynthetic</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">       false</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">                                                                                                                                                                                                                   </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> simple-name</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">       System</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">                                                                                                                                                                                                                  </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> modifier</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">          final,public</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">                                                                                                                                                                                                            </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> annotation</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">                                                                                                                                                                                                                                </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> interfaces</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">                                                                                                                                                                                                                                </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> super-class</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">       +-java.lang.Object</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">                                                                                                                                                                                                      </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> class-loader</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">                                                                                                                                                                                                                              </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> classLoaderHash</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">   null</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">                                                                                                                                                                                                                    </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Affect(row-cnt:1</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">) cost in 39 ms.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">arthas@1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">$ ognl </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">@java.lang.System@getProperty(&quot;java.io.tmpdir&quot;)</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">@String[/tmp]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,16)]))}const k=i(l,[["render",t],["__file","index.html.vue"]]),d=JSON.parse('{"path":"/java/toolUsage/79030a/","title":"Arthas线上排查经验","lang":"en-US","frontmatter":{"title":"Arthas线上排查经验","createTime":"2022-06-14T20:45:19.000Z","permalink":"/java/toolUsage/79030a/"},"headers":[],"readingTime":{"minutes":0.79,"words":236},"git":{"updatedTime":1732499705000,"contributors":[{"name":"qiqiang","email":"qiqiang@pingpongx.com","commits":2,"avatar":"https://avatars.githubusercontent.com/qiqiang?v=4","url":"https://github.com/qiqiang"},{"name":"qiqiang","email":"qiqiang","commits":6,"avatar":"https://avatars.githubusercontent.com/qiqiang?v=4","url":"https://github.com/qiqiang"}]},"filePathRelative":"notes/java/toolUsage/10.Arthas线上排查经验.md","bulletin":false}');export{k as comp,d as data};
